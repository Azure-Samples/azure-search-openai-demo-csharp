@page "/chat"

<PageTitle>@ChatTitle</PageTitle>

<MudGrid Justify="Justify.Center">
    <MudItem xs="12" Style="min-height: 75vh; max-height: 75vh" Class="overflow-x-auto">
        @if (_isReceivingResponse && _intermediateResponse is null)
        {
            <MudProgressCircular Color="Color.Secondary" Indeterminate="true" Class="pb-4" />
        }
        <MudStack Reverse="true">
            @foreach (var response in _responses)
            {
                <MudPaper Class="pa-3" Elevation="3">
                    <MudText Typo="Typo.body1">
                        @((MarkupString)response)
                    </MudText>
                </MudPaper>
            }
            @if (_intermediateResponse is not null)
            {
                <MudPaper Class="pa-3 blue-grey darken-2" Elevation="5" Outlined="true">
                    <MudText Typo="Typo.body1">
                        @((MarkupString)_intermediateResponse)
                    </MudText>
                </MudPaper>
            }
        </MudStack>
    </MudItem>
    <MudItem xs="12" Class="mud-elevation-15 rounded">
        <MudGrid>
            <MudItem xs="11">
                <MudTextField @bind-Value="_userPrompt" Label="@(Prompt)"
                              Variant="Variant.Outlined" Adornment="Adornment.End"
                              AdornmentIcon="@Icons.Material.Filled.QuestionAnswer"
                              AdornmentColor="Color.Secondary" AutoFocus="true"
                              Placeholder="@(ChatPrompt)" Lines="3"
                              Disabled=@_isReceivingResponse IconSize="Size.Large"
                              autocomplete="off" title="@(ChatPrompt)" />
            </MudItem>
            <MudItem xs="1" Class="flex align-self-center">
                <MudFab Color="Color.Secondary" Size="Size.Large"
                        StartIcon=@Icons.Material.Filled.Send
                        OnClick="@OnSendPrompt" Disabled=@_isReceivingResponse />
            </MudItem>
        </MudGrid>
    </MudItem>
</MudGrid>
